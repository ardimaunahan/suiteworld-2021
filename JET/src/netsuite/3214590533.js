function createTimeSelectorField(n,l,p,q,g){var b=NS.jQuery({});b.options=p;b.filters=q;b.filteredOptions=[];b.filteredFavourites=[];b.getFilters=function(){return b.filters};b.disabled=!1;b.isDisabled=function(){return b.disabled};b.setDisabled=function(a){b.disabled=a;b.trigger("disabledChanged")};b.getValue=function(){return a.valueField.val()};b.setValue=function(d,c){null==b.options[d]&&(d="CUSTOM");var e=b.getValue(),f=a.valueField;f.val(d);var k=b.previousValue;b.previousValue=e;b.trigger("valueChanged");
"undefined"!==typeof c&&!c||0!=f.get(0).onchange()||(f.val(e),b.previousValue=k)};b.getTextForValue=function(a){return"CUSTOM"==a?g.labelCustom:(a=b.options[a])?a.text:g.labelCustom};b.getText=function(){return b.getTextForValue(b.getValue())};b.wasRelativeSelector=function(){return"RELATIVE"==b.previousValue};b.useWordBoundaries=function(){if("undefined"!==typeof b._useWordBoundaries)return b._useWordBoundaries;b._useWordBoundaries=!0;var a=0;NS.jQuery.each(b.options,function(c,e){b._useWordBoundaries=
e.text?-1!=e.text.search("(?:^|\\s|$)"+e.text.replace(/[.*+?^${}()|[\]\\]/g,"\\$\x26")+"(?:^|\\s|$)")&&-1==e.text.search(/[\u4E00-\u9FFF]/):!1;if(!b._useWordBoundaries||20<a)return!1;a++});return b._useWordBoundaries};b.getFilterText=function(){return b.filterText};b.setFilterText=function(a){b.filterText=a;b.trigger("filterTextChanged")};b.filterText="";b.filterTextRegexps=[];b.filterTextFirstsRegexp=null;b.putOption=function(a,c,e){e||(e=!1);b.options[a]={value:a,text:c,favourite:e};b.trigger("optionsChanged")};
b.removeOption=function(a){delete b.options[a];b.trigger("optionsChanged")};b.addFavourite=function(a){b.options[a].favourite=!0;NS.jQuery.post(g.selectorServiceURL,{action:"addFavourite",key:a,type:g.selectorType});b.trigger("optionsChanged")};b.removeFavourite=function(a){b.options[a].favourite=!1;NS.jQuery.post(g.selectorServiceURL,{action:"removeFavourite",key:a,type:g.selectorType});b.trigger("optionsChanged")};b.resetTypeFilters=function(){var a=b.getFilters(),c;for(c in a)a.hasOwnProperty(c)&&
(a[c].selected=!1);b.trigger("typeFiltersChanged")};b.toggleTypeFilter=function(a){b.getFilters()[a].selected=!b.getFilters()[a].selected;b.trigger("typeFiltersChanged")};b.optionComparator=function(a,b){if(!a.value&&b.value)return-1;if(!b.value&&a.value)return 1;if(!a.value&&!b.value)return 0;var e=-1!=NS.jQuery.inArray(a.value,["CUSTOM","ALL","RELATIVE"]),f=-1!=NS.jQuery.inArray(b.value,["CUSTOM","ALL","RELATIVE"]);return e&&!f?-1:!e&&f?1:a.text<b.text?-1:a.text==b.text?a.value<b.value?-1:1:1};
b.prepareFilterRegexes=function(){b.useWordBoundaries()?b.prepareFilterRegexesNormal():b.prepareFilterRegexesNoWords()};b.prepareFilterRegexesNormal=function(){var a=null!=b.getFilterText()?b.getFilterText().replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$\x26"):"";b.filterTextRegexps=[];""!==a&&(b.filterTextRegexps=NS.jQuery.map(a.split(" "),function(a){return a?new RegExp("((?:^|\\s|$)"+a+")()","ig"):null}));if(/^\S{2,6}$/.test(a)){var c="";NS.jQuery.each(a.split(""),function(a,b){c+="((?:^|\\s|$)"+b+")(.*)"});
b.filterTextFirstsRegexp=new RegExp(c,"ig")}else b.filterTextFirstsRegexp=null};b.prepareFilterRegexesNoWords=function(){var a=null!=b.getFilterText()?b.getFilterText().replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$\x26"):"";b.filterTextRegexps=[];""!==a&&(b.filterTextRegexps=NS.jQuery.map(a.split(" "),function(a){return a?new RegExp("("+a+")()","ig"):null}));b.filterTextFirstsRegexp=null};b.getSortedOptionsWithoutDuplicates=function(){var a=NS.jQuery.map(b.options,function(a){return a});a.sort(b.optionComparator);
var c=[],e=null,f=b.getValue();NS.jQuery.each(a,function(a,b){null==e||b.text!=e.text?(c.push(b),e=b):b.value==f&&(c[c.length-1]=b)});return c};b.filterOptions=function(){b.filteredOptions=[];b.filteredFavourites=[];var a=b.getSortedOptionsWithoutDuplicates();b.prepareFilterRegexes();var c=[];NS.jQuery.each(a,function(a,d){var k=!0;NS.jQuery.each(b.getFilters(),function(a,b){if(b.selected&&0===(b.code&d.tagsCode))return k=!1});k&&c.push(d)});NS.jQuery.grep(c,function(a){var d=!1;null!=b.filterTextFirstsRegexp&&
(d=-1!=a.text.search(b.filterTextFirstsRegexp));d||(d=!0,NS.jQuery.each(b.filterTextRegexps,function(b,c){return-1==a.text.search(c)?d=!1:!0}));d&&(a.favourite?b.filteredFavourites.push(a):b.filteredOptions.push(a))})};var a={format:function(a,b){return a.replace(/\{\{|\}\}|\{(\w+)\}/g,function(a,d){return"{{"==a?"{":"}}"==a?"}":b[d]})},render:function(b,c){return a.format(b,c)}};a.rootElem=NS.jQuery("#"+n);a.popupElem=a.rootElem.find(".selector-popup");a.filterField=a.rootElem.find(".selector-filter-input");
a.valueField=a.rootElem.find("[name\x3d"+l+"]");a.allOptionsElem=a.rootElem.find(".selector-options");a.favouritesElem=a.rootElem.find(".selector-favourites");a.optionsElem=a.rootElem.find(".selector-all");a.typeFiltersElem=a.rootElem.find(".selector-filters");a.suppressMouseOver=!1;a.rootElem.data("controller",b);a.rootElem.prop("controller",b);a.renderValue=function(){a.filterField.val(b.getText())};a.renderOptions=function(){a.favouritesElem.empty();a.optionsElem.empty();b.filterOptions();var d=
[];NS.jQuery.merge(d,NS.jQuery.map(b.filterTextRegexps,function(a){return a.source}));null!=b.filterTextFirstsRegexp&&d.push(b.filterTextFirstsRegexp.source);var c=0===d.length?null:new RegExp(d.join("|"),"ig"),e=function(a){a=NS.jQuery.extend({},a);a.highlightedText=c&&a.text?a.text.replace(c,function(){for(var a="",b=1;b<arguments.length-2;b++){var d=arguments[b];"undefined"!=typeof d&&(a=1==b%2?a+("\x3cb\x3e"+d+"\x3c/b\x3e"):a+d)}return a}):a.text;return a};NS.jQuery.each(b.filteredOptions,function(b,
d){a.optionsElem.append(a.render('\x3cdiv class\x3d"selector-item" data-value\x3d"{value}" title\x3d"{text}"\x3e\x3cspan class\x3d"selector-star"\x3e\x26nbsp;\x3c/span\x3e{highlightedText}\x3c/div\x3e',e(d)))});NS.jQuery.each(b.filteredFavourites,function(b,d){a.favouritesElem.append(a.render('\x3cdiv class\x3d"selector-item" data-value\x3d"{value}" title\x3d"{text}"\x3e\x3cspan class\x3d"selector-star"\x3e\x26nbsp;\x3c/span\x3e{highlightedText}\x3c/div\x3e',e(d)))});var f=0===a.favouritesElem.children().length;
a.rootElem.find(".selector-favourites-container").toggleClass("selector-folder-disabled",f);f&&a.toggleFold(a.rootElem.find(".selector-all-container"),!1);0<d.length&&(a.toggleFold(a.rootElem.find(".selector-all-container"),!1),a.toggleFold(a.rootElem.find(".selector-favourites-container"),!1));var k=b.getValue();a.rootElem.find(".selector-item").filter(function(a,b){return NS.jQuery(b).data()==k}).addClass("selector-selected")};a.renderTypeFilters=function(){a.typeFiltersElem.empty();var d,c,e=function(){d=
NS.jQuery(document.createElement("tr"));a.typeFiltersElem.append(d);c=3};e();NS.jQuery.each(b.filters,function(f,k){0===c&&e();d.append(a.render('\x3ctd class\x3d"selector-filter-button" data-filter\x3d"{value}"\x3e\x3cspan\x3e{text}\x3cspan\x3e\x3c/td\x3e',k));var h=d.children().last(),g=h.children().width(),g=g>2*h.width()?3:g>h.width()?2:1;if(c<g){var l=d,m=c;e();h.detach();for(h.appendTo(d);0<m;m--)l.append(document.createElement("td"))}c-=g;h.attr("colspan",g);b.getFilters()[h.data("filter")].selected?
h.addClass("checked"):h.removeClass("checked")})};a.openPopup=function(){var d=NS.jQuery(window);0<a.rootElem.closest("#fieldset_options_div").length&&a.rootElem.closest(".uir-tooltip-content").css("overflow","visible");a.filterField.parent().css("z-index","1001");a.popupElem.find(".selector-input-spacer").remove();a.popupElem.removeClass("above below below-fixed");a.popupElem.find(".selector-popup-fixedposition").css({position:"",top:"",bottom:""});d.off("."+l);var c=a.rootElem.parents().filter(function(a,
b){return"visible"!=NS.jQuery(b).css("overflow")||"BODY"==b.tagName}).first(),e=a.filterField.offset().top-c.offset().top,c=c.offset().top+c.height()-45-a.filterField.offset().top;if(270>e&&270>c&&0===a.rootElem.closest("#outerwrapper").length){var f=function(){var b=a.filterField.offset().top;return{top:b-d.scrollTop(),bottom:d.height()-b+d.scrollTop(),left:a.filterField.offset().left-d.scrollLeft()}},e=f();270>e.bottom?(a.popupElem.addClass("above"),a.popupElem.prepend('\x3cdiv class\x3d"selector-input-spacer bottom"\x3e\x3c/div\x3e'),
c=function(){var b=f();a.popupElem.find(".selector-popup-fixedposition").css({position:"fixed",bottom:b.bottom+3+"px",left:b.left-5+"px"})},a.allOptionsElem.height(Math.max(e.top-110,150))):(a.popupElem.addClass("below"),a.popupElem.prepend('\x3cdiv class\x3d"selector-input-spacer top"\x3e\x3c/div\x3e'),c=function(){var b=f();a.popupElem.find(".selector-popup-fixedposition").css({position:"fixed",top:b.top+28+"px",left:b.left-5+"px"})},a.allOptionsElem.height(Math.max(e.bottom-140,150)));c();d.on("scroll."+
l,c);d.on("resize."+l,c)}else 270>e||e<c?(a.popupElem.addClass("below"),a.popupElem.prepend('\x3cdiv class\x3d"selector-input-spacer top"\x3e\x3c/div\x3e'),a.allOptionsElem.height(Math.max(c-95,150))):(a.popupElem.addClass("above"),a.popupElem.append('\x3cdiv class\x3d"selector-input-spacer bottom"\x3e\x3c/div\x3e'),a.allOptionsElem.height(Math.max(e-95,150)));a.popupElem.find(".selector-input-spacer").width(a.filterField.outerWidth()+8);a.rootElem.find(".i_dropdownarrow").hide();a.renderOptions();
a.filterField.val("");b.setFilterText("");a.popupElem.show();a.renderTypeFilters()};a.closePopup=function(){NS.jQuery(window).off("."+l);a.filterField.parent().css("z-index","auto");a.popupElem.hide();a.rootElem.find(".i_dropdownarrow").show();b.setFilterText("");a.renderValue();b.resetTypeFilters()};a.isPopupOpen=function(){return"none"!=a.popupElem.css("display")};a.toggleFold=function(a,b){var e=null==b?null:!b;a.toggleClass("selector-folder-closed",b);a.toggleClass("selector-folder-open",e)};
a.isFolderDisabled=function(a){return a.hasClass("selector-folder-disabled")};b.on("optionsChanged",function(){a.renderOptions();!b.options[b.getValue()]&&b.filteredOptions&&0<b.filteredOptions.length&&b.setValue(b.filteredOptions[0].value)});b.on("valueChanged",function(){a.renderValue()});b.on("typeFiltersChanged",function(){a.renderTypeFilters();a.renderOptions()});b.on("filterTextChanged",function(){a.renderOptions()});b.on("disabledChanged",function(){var d=b.isDisabled();a.filterField.prop("disabled",
d);d?(a.filterField.closest(".uir-field").addClass("effectDisabled"),a.closePopup()):a.filterField.closest(".uir-field").removeClass("effectDisabled")});a.rootElem.find(".nldropdown").on("click",function(){a.isPopupOpen()||b.isDisabled()||a.openPopup()});a.filterField.on("focus",function(){a.isPopupOpen()||b.isDisabled()||a.openPopup()});var m;a.filterField.on("keyup",function(d){m&&clearTimeout(m);-1==[13,27,38,40].indexOf(d.which)&&(m=setTimeout(function(){b.setFilterText(a.filterField.val())},
200))});a.allOptionsElem.find(".selector-favourites-container h3").on("click",function(){var b=a.favouritesElem.parent();a.isFolderDisabled(b)||a.toggleFold(b)});a.allOptionsElem.find(".selector-all-container h3").on("click",function(){var b=a.optionsElem.parent();a.isFolderDisabled(b)||a.toggleFold(b)});a.rootElem.on("click",".selector-item",function(){b.setValue(NS.jQuery(this).data("value"));a.closePopup();a.filterField.blur();return!1});a.rootElem.on("click",".selector-all .selector-star",function(){var a=
NS.jQuery(this).closest("[data-value]").data("value");b.addFavourite(a);return!1});a.rootElem.on("click",".selector-favourites .selector-star",function(){var a=NS.jQuery(this).closest("[data-value]").data("value");b.removeFavourite(a);return!1});a.rootElem.find(".selector-filters").on("click","td",function(){b.toggleTypeFilter(NS.jQuery(this).data("filter"))});NS.jQuery(document).on("mouseup",function(b){a.isPopupOpen()&&(a.popupElem.is(b.target)||0!==a.popupElem.has(b.target).length||a.filterField.is(b.target)||
0!==a.filterField.has(b.target).length||a.closePopup())});a.filterField.on("keypress",function(d){if(a.isPopupOpen()&&27==d.which)a.filterField.blur(),a.closePopup();else if(13==d.which){var c=a.allOptionsElem.find(".selector-selected");0<c.length&&(a.closePopup(),a.filterField.blur(),b.setValue(c.data("value")));d.preventDefault();return!1}return!0});a.filterField.on("keydown",function(b){if(38==b.which||40==b.which){b.preventDefault();var c=a.allOptionsElem.find(".selector-selected"),e=a.allOptionsElem.find(".selector-item").filter(":visible"),
f;0===c.length?38==b.which?f=e.last():40==b.which&&(f=e.first()):38==b.which?(f=c.prev(),0===f.length&&c.parent().is(a.optionsElem)&&(f=a.favouritesElem.find(".selector-item:last"))):40==b.which&&(f=c.next(),0===f.length&&c.parent().is(a.favouritesElem)&&(f=a.optionsElem.find(".selector-item:first")));if(0!==f.length){a.toggleFold(f.parent().parent(),!1);b=a.allOptionsElem.position().top;var c=a.allOptionsElem.outerHeight(!0),e=a.allOptionsElem.scrollTop(),g=f.position().top,h=f.outerHeight(!0);0>
g-b?(a.suppressMouseOver=!0,a.allOptionsElem.scrollTop(e+g-b)):0<g+h-b-c&&(a.suppressMouseOver=!0,a.allOptionsElem.scrollTop(e+g+h-b-c));a.allOptionsElem.find(".selector-selected").removeClass("selector-selected");f.addClass("selector-selected")}}});a.popupElem.on("mouseover",".selector-item",function(b){a.suppressMouseOver?a.suppressMouseOver=!1:(b=NS.jQuery(b.target).closest(".selector-item"),a.popupElem.find(".selector-selected").removeClass("selector-selected"),b.addClass("selector-selected"))});
b.setValue(b.getValue(),!1);b.setDisabled(g.disabled)};
//# sourceMappingURL=/assets/legacy_timeselector/3214590533.map